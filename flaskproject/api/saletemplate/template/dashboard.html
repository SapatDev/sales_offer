{% extends 'base.html' %}


{% block content %}


<div class="main-panel">
  <div class="content-wrapper">
    <!-- <div class="row">
      <div class="col-sm-6">
          <h3 class="mb-0 font-weight-bold">Kenneth Osborne</h3>
          <p>Your last login: 21h ago from newzealand.</p>
        </div> 
        <div class="col-sm-6">
          <div class="d-flex align-items-center justify-content-md-end">
            <div class="mb-3 mb-xl-0 pr-1">
                <div class="dropdown">
                  <button class="btn bg-white btn-sm dropdown-toggle btn-icon-text border mr-2" type="button" id="dropdownMenu3" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      <i class="typcn typcn-calendar-outline mr-2"></i>Last 7 days
                  </button>
                  <div class="dropdown-menu" aria-labelledby="dropdownMenuSizeButton3" data-x-placement="top-start">
                    <h6 class="dropdown-header">Last 14 days</h6>
                    <a class="dropdown-item" href="#">Last 21 days</a>
                    <a class="dropdown-item" href="#">Last 28 days</a>
                  </div>
                </div>
            </div>
            <div class="pr-1 mb-3 mr-2 mb-xl-0">
              <button type="button" class="btn btn-sm bg-white btn-icon-text border"><i class="typcn typcn-arrow-forward-outline mr-2"></i>Export</button>
            </div>
            <div class="pr-1 mb-3 mb-xl-0">
              <button type="button" class="btn btn-sm bg-white btn-icon-text border"><i class="typcn typcn-info-large-outline mr-2"></i>info</button>
            </div>
          </div>
        </div> 
      </div> -->
    <div class="row  mt-3">
      <div class="col-xl-7 d-flex grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-wrap justify-content-between">
              <h4 class="card-title mb-3">Scheme Summary</h4>
            </div>
            <div class="row">
              <div class="col-12">
                <div class="row">
                  <div class="col-lg-6">
                    <!-- <div id="circleProgress6" class="progressbar-js-circle rounded p-3"></div> -->
                    <canvas id="myDoughnutChart" width="250" height="300"></canvas>

                  </div>
                  
                  <div class="col-lg-6">
                    <ul class="session-by-channel-legend">
                      <li>
                        <div class="update-trigger" onclick="updateScore({{ssc_count_data}})">SweetSummerOffer2</div>
                        <div style="margin-left: 10px; color: #FF0000;">58506</div>
                      </li>
                      <li>
                        <div class="update-trigger" onclick="updateScore({{spd_count_data}})">SpecialDiscountoffer</div>
                        <div style="margin-left: 10px; color: #800080;">31479</div>
                      </li>
                      <li>
                        <div class="update-trigger" onclick="updateScore({{monsoon_count_data}})">Mansoonoffer</div>
                        <div style="margin-left: 10px; color:#32CD32;">25832</div>
                      </li>
                      <li>
                        <div class="update-trigger" onclick="updateScore({{winter_count_data}})">WinterSpecialoffer
                        </div>
                        <div style="margin-left: 10px; color: #ff0080;">10113</div>
                        
                      </li>
                      <li>
                        <div class="update-trigger" onclick="updateScore({{ek_se_count_data}})">Eksebadhkarek2</div>
                        <div style="margin-left: 10px; color: #ffff00;">32844</div>
                     
                      </li>
                      <li>
                        <div class="update-trigger" onclick="updateScore({{ek_se_count_data}})">NewYearDhamaka</div>
                        <div style="margin-left: 10px; color: #0000CD;">176585</div>
                    
                      </li>
                    </ul>
                  </div>


                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- <div class="col-xl-3 d-flex grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-wrap justify-content-between">
              <h4 class="card-title mb-3">Events</h4>
            </div>
            <div class="row">
              <div class="col-12">
                <div class="row">
                  <div class="col-sm-12">
                    <div class="d-flex justify-content-between mb-md-5 mt-3">
                      <div class="small">Critical</div>
                      <div class="text-danger small">Error</div>
                      <div class="text-warning small">Warning</div>
                    </div>
                    <canvas id="eventChart"></canvas>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div> -->

      <div class="col-xl-5 d-flex grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-wrap justify-content-between">
              <h4 class="card-title mb-3">Annual Data</h4>
            </div>
            <div class="row">
              <div class="col-12">
                <div class="row">
                  <div class="col-sm-12">
                    <div class="d-flex justify-content-between mb-4">
                      <div>Annual Target</div>
                      <div class="text-danger">{{Annual_Target}}</div>
                    </div>
                    <div class="d-flex justify-content-between mb-4">
                      <div>Annual Sales Ty</div>
                      <div class="text-muted">{{Annual_Sales}}</div>
                    </div>
                    <div class="d-flex justify-content-between mb-4">
                      <div>Annual Sales Ly</div>
                      <div class="text-success">{{Annual_Sales_LY}}</div>
                    </div>
                    <!-- <div class="d-flex justify-content-between mb-4">
                        <div>Memory space</div>
                        <div class="text-muted">168.3GB</div>
                      </div> -->
                    <div class="progress progress-md mt-4">
                      <div class="progress-bar bg-danger" role="progressbar" style="width: {{ percentage_last_year }}%" aria-valuenow="{{ percentage_last_year }}"
                      aria-valuemin="0" aria-valuemax="100">{{ percentage_last_year }}%</div>
                    </div>
                    <div class="progress progress-md mt-4">
                      <div class="progress-bar bg-success" role="progressbar" style="width: {{ percentage_achieved }}%" aria-valuenow="{{ percentage_achieved }}"
                      aria-valuemin="0" aria-valuemax="100">{{percentage_achieved}}%</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-xl-4 d-flex grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-wrap justify-content-between">
              <h4 class="card-title mb-3">All Scheme</h4>
            </div>
            <div class="row">
              <div class="col-12">
                <div class="row">
                  <div class="col-sm-12">
                    {% for item in dict_list1 %}
                    <div class="d-flex justify-content-between mb-4">
                      <!-- this apply for first  href="/offer/{{ item['offer_id'] }}/{{ item['id'] }}?offer_name={{ item['id'] }}" -->
                      <div class="text-secondary font-weight-medium"><a id="{{ item['offer_name'] }}"
                          onclick="setOfferName(id)"
                          href="/offer/{{ item['offer_id'] }}/{{ item['id'] }}?offer_name={{ item['id'] }}&from_date={{ from_date }}&to_date={{ to_date }}"
                          
                          class="offer-link"> {{ item['offer_name'] }}</a></div>
                      <div class="small"><h5>{{ item['offer_id'] }}</h4></div>
                    </div>
                    {% endfor %}
                    <!-- <div class="d-flex justify-content-between mb-4">
                      <div class="text-secondary font-weight-medium">Russell Floyd</div>
                      <div class="small">$857</div>
                    </div>
                    <div class="d-flex justify-content-between mb-4">
                      <div class="text-secondary font-weight-medium">Douglas White</div>
                      <div class="small">$612 </div>
                    </div>
                    <div class="d-flex justify-content-between mb-4">
                      <div class="text-secondary font-weight-medium">Alta Fletcher </div>
                      <div class="small">$233</div>
                    </div>
                    <div class="d-flex justify-content-between mb-4">
                      <div class="text-secondary font-weight-medium">Marguerite Pearson</div>
                      <div class="small">$233</div>
                    </div> -->
                    <!-- <div class="d-flex justify-content-between mb-4">
                        <div class="text-secondary font-weight-medium">Leonard Gutierrez</div>
                        <div class="small">$35</div>
                      </div>
                      <div class="d-flex justify-content-between mb-4">
                        <div class="text-secondary font-weight-medium">Helen Benson</div>
                        <div class="small">$43</div>
                      </div>
                      <div class="d-flex justify-content-between">
                          <div class="text-secondary font-weight-medium">Helen Benson</div>
                          <div class="small">$43</div>
                        </div> -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-xl-8 d-flex grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-wrap justify-content-between">
              <h4 class="card-title mb-3">Closing Stock Report</h4>
              <button type="button" class="btn btn-sm btn-light"><a href="/closingsale">closing Stock</a></button>
            </div>
            <div class="row">
              <div class="col-12">
                <div class="d-md-flex mb-4">
                  <div class="mr-md-5 mb-4">
                    <h5 class="mb-1"><i class="typcn typcn-globe-outline mr-1"></i>Opening</h5>
                    <h2 class="text-primary mb-1 font-weight-bold">{{ stock_opening }}</h2>
                  </div>
                  <div class="mr-md-5 mb-4">
                    <h5 class="mb-1"><i class="typcn typcn-archive mr-1"></i>Closing</h5>
                    <h2 class="text-secondary mb-1 font-weight-bold"> {{ stock_closing  }}</h2>
                  </div>
                  <div class="mr-md-5 mb-4">
                    <h5 class="mb-1"><i class="typcn typcn-tags mr-1"></i>Primary_Stock</h5>
                    <h2 class="text-success mb-1 font-weight-bold">{{ stock_primary_stock }}</h2>
                  </div>
                  <div class="mr-md-5 mb-4">
                    <h5 class="mb-1"><i class="typcn typcn-tags mr-1"></i>Secondary</h5>
                    <h2 class="text-warning mb-1 font-weight-bold">{{ stock_secondary }}</h2>
                  </div>
                </div>
                <canvas id="barChartStacked"></canvas>
                <!-- <canvas id="salesanalyticChart" width="1000" height="600"></canvas> -->
              </div>
            </div>
          </div>
        </div>
      </div>



      <!-- <div class="col-xl-3 d-flex grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-wrap justify-content-between">
              <h4 class="card-title mb-3">Card Title</h4>
            </div>
            <div class="row">
              <div class="col-12">
                <div class="mb-5">
                  <div class="mr-1">
                    <div class="text-info mb-1">
                      Total Earning
                    </div>
                    <h2 class="mb-2 mt-2 font-weight-bold">287,493$</h2>
                    <div class="font-weight-bold">
                      1.4% Since Last Month
                    </div>
                  </div>
                  <hr>
                  <div class="mr-1">
                    <div class="text-info mb-1">
                      Total Earning
                    </div>
                    <h2 class="mb-2 mt-2  font-weight-bold">87,493</h2>
                    <div class="font-weight-bold">
                      5.43% Since Last Month
                    </div>
                  </div>
                </div>
                <canvas id="barChartStacked"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div> -->
    </div>

    <div class="row">
      <div class="col-lg-12 d-flex grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-wrap justify-content-between">
              <h4 class="card-title mb-3">{{ current_month }} Sale Analytics</h4>
            </div>
            <div class="row">
              <div class="col-lg-9">
                <div class="d-sm-flex justify-content-between">
                  <div class="dropdown">
                    <button class="btn bg-white btn-sm dropdown-toggle btn-icon-text pl-0" type="button"
                      id="dropdownMenuSizeButton4" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      {{selected_date}}
                    </button>
                    <div class="dropdown-menu" aria-labelledby="dropdownMenuSizeButton4" data-x-placement="top-start">
                      {% for dates in ecommerce_analytics %}
                      <!-- <h6 class="dropdown-item">{{loop.index}}</h6> -->
                      {% if loop.index == 0 %}
                      <a class="dropdown-header" onclick="updateEcommerceGraph('{{dates}}')">{{dates}}</a>
                      {% else %}
                      <a class="dropdown-item" onclick="updateEcommerceGraph('{{dates}}')">{{dates}}</a>
                      {% endif %}
                      <!-- <a class="dropdown-item" href="#">Wed,19 Oct 2019 - Thu,26 Oct 2019</a> -->
                      {% endfor %}
                    </div>
                  </div>
                  <!-- <form action="{{ url_for('Dashboard', from_date=from_date,to_date=to_date, _external=True) }}" method="GET">
                    <label for="from_date">From Date:</label>
                    <select id="from_date" name="from_date">
                        <option value="2024-01-01">2024-01-01</option>
                        <option value="2024-01-01">2024-02-01</option>
                      
                    </select>
                    <label for="to_date">To Date:</label>
                    <select id="to_date" name="to_date">
                        <option value="2024-02-01">2024-02-01</option>
                        <option value="2024-01-01">2024-03-01</option>
                       
                    </select>
                    <button type="submit">Submit</button>
                </form> -->


                  <!-- <div>
                    <button type="button" class="btn btn-sm btn-light mr-2">Day</button>
                    <button type="button" class="btn btn-sm btn-light mr-2">Week</button>
                    <button type="button" class="btn btn-sm btn-light">Month</button>
                  </div> -->
                </div>
                <div class="chart-container mt-4">
                  <canvas id="ecommerceAnalytic"></canvas>
                </div>
              </div>
              <div class="col-lg-3">
                <div>
                  <div class="d-flex justify-content-between mb-3">
                    <div class="text-info font-weight-bold">{{ previous_month_name  }}</div>
                  </div>
                  <div class="d-flex justify-content-between mb-3">
                    <div class="font-weight-medium">Target Sale</div>
                    <div class="text-muted">{{ Target_Sale_previous  }}</div>
                  </div>
                  <div class="d-flex justify-content-between mb-3">
                    <div class="font-weight-medium">Month Sale</div>
                    <div class="text-muted">{{ Month_Sale_previous  }}</div>
                  </div>
                  <!-- <div class="d-flex justify-content-between mb-3">
                    <div class="font-weight-medium">Maximum</div>
                    <div class="text-muted">68.14M</div>
                  </div> -->
                  <!-- <div class="d-flex justify-content-between mb-3">
                    <div class="font-weight-medium">60th %</div>
                    <div class="text-muted">168.3GB</div>
                  </div> -->
                </div>
                <hr>
                <div class="mt-4">
                  <div class="d-flex justify-content-between mb-3">
                    <div class="text-info font-weight-bold">{{ current_month }}</div>
                  </div>
                  <div class="d-flex justify-content-between mb-3">
                    <div class="font-weight-medium">Target Sale</div>
                    <div class="text-danger">{{Target_Sale_current}}</div>
                  </div>
                  <div class="d-flex justify-content-between mb-3">
                    <div class="font-weight-medium">Month Sale</div>
                    <div class="text-success">{{Month_Sale_current}}</div>
                  </div>
                  <!-- <div class="d-flex justify-content-between mb-3">
                    <div class="font-weight-medium">Maximum</div>
                    <div class="text-muted">15.50K</div>
                  </div>
                  <div class="d-flex justify-content-between">
                    <div class="font-weight-medium">60th %</div>
                    <div class="text-muted">45.5</div>
                  </div> -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-4 d-flex grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-wrap justify-content-between">
              <h4 class="card-title mb-3">Sale Analysis Trend</h4>
            </div>
            <div class="mt-2">
              <div class="d-flex justify-content-between">
                <small>Order Value</small>
                <small>155.5%</small>
              </div>
              <div class="progress progress-md  mt-2">
                <div class="progress-bar bg-secondary" role="progressbar" style="width: 80%" aria-valuenow="90"
                  aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </div>
            <div class="mt-4">
              <div class="d-flex justify-content-between">
                <small>Total Products</small>
                <small>238.2%</small>
              </div>
              <div class="progress progress-md  mt-2">
                <div class="progress-bar bg-success" role="progressbar" style="width: 50%" aria-valuenow="90"
                  aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </div>
            <div class="mt-4 mb-5">
              <div class="d-flex justify-content-between">
                <small>Quantity</small>
                <small>23.30%</small>
              </div>
              <div class="progress progress-md mt-2">
                <div class="progress-bar bg-warning" role="progressbar" style="width: 70%" aria-valuenow="90"
                  aria-valuemin="0" aria-valuemax="100"></div>
              </div>
            </div>
            <canvas id="salesTopChart"></canvas>
          </div>
        </div>
      </div>
      <div class="col-lg-8 d-flex grid-margin stretch-card">
        <div class="card">
          <div class="card-body">
            <div class="d-flex flex-wrap justify-content-between">
              <h4 class="card-title mb-3">Project status</h4>
            </div>
            <div class="table-responsive">
              <table class="table">
                <tbody>
                  <tr>
                    <td>
                      <div class="d-flex">
                        <img class="img-sm rounded-circle mb-md-0 mr-2" src="images/faces/face30.png"
                          alt="profile image">
                        <div>
                          <div> Company</div>
                          <div class="font-weight-bold mt-1">volkswagen</div>
                        </div>
                      </div>
                    </td>
                    <td>
                      Budget
                      <div class="font-weight-bold  mt-1">$2322 </div>
                    </td>
                    <td>
                      Status
                      <div class="font-weight-bold text-success  mt-1">88% </div>
                    </td>
                    <td>
                      Deadline
                      <div class="font-weight-bold  mt-1">07 Nov 2019</div>
                    </td>
                    <td>
                      <button type="button" class="btn btn-sm btn-secondary">edit actions</button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div class="d-flex">
                        <img class="img-sm rounded-circle mb-md-0 mr-2" src="images/faces/face31.png"
                          alt="profile image">
                        <div>
                          <div> Company</div>
                          <div class="font-weight-bold  mt-1">Land Rover</div>
                        </div>
                      </div>
                    </td>
                    <td>
                      Budget
                      <div class="font-weight-bold  mt-1">$12022 </div>
                    </td>
                    <td>
                      Status
                      <div class="font-weight-bold text-success  mt-1">70% </div>
                    </td>
                    <td>
                      Deadline
                      <div class="font-weight-bold  mt-1">08 Nov 2019</div>
                    </td>
                    <td>
                      <button type="button" class="btn btn-sm btn-secondary">edit actions</button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div class="d-flex">
                        <img class="img-sm rounded-circle mb-md-0 mr-2" src="images/faces/face32.png"
                          alt="profile image">
                        <div>
                          <div> Company</div>
                          <div class="font-weight-bold  mt-1">Bentley </div>
                        </div>
                      </div>
                    </td>
                    <td>
                      Budget
                      <div class="font-weight-bold  mt-1">$8,725</div>
                    </td>
                    <td>
                      Status
                      <div class="font-weight-bold text-success  mt-1">87% </div>
                    </td>
                    <td>
                      Deadline
                      <div class="font-weight-bold  mt-1">11 Jun 2019</div>
                    </td>
                    <td>
                      <button type="button" class="btn btn-sm btn-secondary">edit actions</button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div class="d-flex">
                        <img class="img-sm rounded-circle mb-md-0 mr-2" src="images/faces/face33.png"
                          alt="profile image">
                        <div>
                          <div> Company</div>
                          <div class="font-weight-bold  mt-1">Morgan </div>
                        </div>
                      </div>
                    </td>
                    <td>
                      Budget
                      <div class="font-weight-bold  mt-1">$5,220 </div>
                    </td>
                    <td>
                      Status
                      <div class="font-weight-bold text-success  mt-1">65% </div>
                    </td>
                    <td>
                      Deadline
                      <div class="font-weight-bold  mt-1">26 Oct 2019</div>
                    </td>
                    <td>
                      <button type="button" class="btn btn-sm btn-secondary">edit actions</button>
                    </td>
                  </tr>
                  <tr>
                    <td>
                      <div class="d-flex">
                        <img class="img-sm rounded-circle mb-md-0 mr-2" src="images/faces/face34.png"
                          alt="profile image">
                        <div>
                          <div> Company</div>
                          <div class="font-weight-bold  mt-1">volkswagen</div>
                        </div>
                      </div>
                    </td>
                    <td>
                      Budget
                      <div class="font-weight-bold  mt-1">$2322 </div>
                    </td>
                    <td>
                      Status
                      <div class="font-weight-bold text-success mt-1">88% </div>
                    </td>
                    <td>
                      Deadline
                      <div class="font-weight-bold  mt-1">07 Nov 2019</div>
                    </td>
                    <td>
                      <button type="button" class="btn btn-sm btn-secondary">edit actions</button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


<script>
  $(document).ready(
    function () {
      if ($('#circleProgress6').length) {
        var bar = new ProgressBar.Circle(circleProgress6, {
          color: '#001737',
          // This has to be the same size as the maximum width to
          // prevent clipping
          strokeWidth: 10,
          trailWidth: 10,
          easing: 'easeInOut',
          duration: 1400,
          text: {
            autoStyleContainer: false
          },
          from: {
            color: '#aaa',
            width: 10
          },
          to: {
            color: '#2617c9',
            width: 10
          },
          // Set default step function for all animate calls
          step: function (state, circle) {
            circle.path.setAttribute('stroke', state.color);
            circle.path.setAttribute('stroke-width', state.width);

            var value = '<p id="score" class="text-center mb-0">Score ' + Math.round(({{ ek_se_count_data| tojson}} / 75000) * 100) + "%</p>";
  if (value === 0) {
    circle.setText('');
  } else {
    circle.setText(value);
  }
  
        }
      });

  bar.text.style.fontSize = '1.875rem';
  bar.text.style.fontWeight = '700';
  bar.animate(.75); // Number from 0.0 to 1.0
    }

    
    }

    
  )

  function updateScore(amount) {
    $("#score").text("Score " + Math.round((amount / 75000) * 100) + "%")

  }
</script>

<script>
  $(document).ready(
    function () {
      // console.log({{ closing_values| tojson}});
      var salesanalyticData = {
        labels: {{ labels| tojson}},
    datasets: [{
      label: 'Closing',
      data: {{ closing_values| tojson}},
    borderColor: [
      '#3022cb'
    ],
    borderWidth: 3,
    backgroundColor: "rgba(255, 0, 54)",
    fill: false,
        },
    {
      label: 'Opening',
      data: {{ opening_values| tojson}},
    borderColor: [
      '#ff8300',
    ],
    borderWidth: 3,
    backgroundColor: "rgb(0, 0, 255)",
    fill: false,
        },
    {
      label: 'Primary',
      data: {{ primary_stock_values| tojson}},
    borderColor: [
      '#f2125e',
    ],
    borderWidth: 3,
    backgroundColor: "rgb(255, 165, 0)",
    fill: false,
        }
  ],
      };
  var salesanalyticOptions = {
    scales: {

      yAxes: [{

        display: true,
        gridLines: {
          drawBorder: false,
          display: true,
        },
        ticks: {
          display: true,
          beginAtZero: true,
          stepSize: 100000
        }
      }],
      xAxes: [{
        display: true,
        position: 'bottom',
        gridLines: {
          drawBorder: false,
          display: false,
        },
        ticks: {
          display: true,
          beginAtZero: true,
          stepSize: 5
        }
      }],

    },
    legend: {
      display: false,
      labels: {
        boxWidth: 0,
      }
    },
    elements: {
      point: {
        radius: 0
      },
      line: {
        tension: .4,
      },
    },
    tooltips: {
      backgroundColor: 'rgba(2, 171, 254, 1)',
    }
  };
  if ($("#salesanalyticChart").length) {
    var lineChartCanvas = $("#salesanalyticChart").get(0).getContext("2d");
    var saleschart = new Chart(lineChartCanvas, {
      type: 'line',
      data: salesanalyticData,
      options: salesanalyticOptions
    });
  }
    }
  )

</script>

<!-- Sale Analytics    -->

<script>
  $(document).ready(
    function () {
      // console.log({{ salesgroup_daily| tojson}})
      makeEcommerceGraph()
    }
  )

  let saleschart;
  function makeEcommerceGraph(salesData, targetData, labels) {
    var eCommerceAnalyticData = {
      labels: !!labels ? labels : {{ salesgroup_daily| tojson}},


  // labels: ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41"],
  datasets: [{
    label: 'Sale',

    data: !!salesData ? salesData : {{ sale_dailydata| tojson}},


    // data: [56, 56, 55, 59, 59, 59, 57, 56, 57, 54, 56, 58, 57, 59, 58, 59, 57, 55, 56, 54, 52, 52, 50, 50, 50, 52, 48, 49, 50, 52, 53, 52, 55, 54, 53, 56, 55, 56, 55, 54, 55, 57, 58, 56, 55, 56, 57, 58, 59, 58, 57, 55, 53, 52, 55, 57, 55, 54, 52, 55, 57, 56, 57, 58, 59, 58, 59, 57, 56, 55, 57, 58, 59, 60, 62, 60, 59, 58, 57, 56, 57, 56, 58, 59],
  //   borderColor: [
  //   '#392ccd'

  // ],
    borderWidth: 3,
    fill: true,
    backgroundColor: '#17c964'
        },
  {
    label: 'Target',
    data: !!targetData ? targetData : {{ Target_data| tojson}},
    // data: [32, 32, 35, 39, 39, 39, 37, 36, 37, 34, 36, 38, 37, 39, 38, 39, 37, 35, 36, 34, 30, 28, 31, 29, 27, 24, 23, 26, 25, 27, 28, 29, 32, 30, 33, 31, 35, 34, 32, 35, 37, 35, 36, 34, 30, 28, 28, 28, 32, 29, 33, 35, 33, 32, 35, 37, 35, 34, 32, 35, 37, 36, 37, 38, 39, 38, 39, 37, 36, 35, 37, 38, 39, 36, 37, 35, 39, 38, 37, 36, 37, 36, 38, 39],
  //   borderColor: [
  //   '#17c964',
  // ],
    borderWidth: 3,
    fill: true,
    backgroundColor: "rgba(255, 0, 54)",
        }
  ],
      };
  var eCommerceAnalyticOptions = {
    scales: {
      yAxes: [{
        display: true,
        gridLines: {
          drawBorder: false,
          display: true,
        },
        ticks: {
          display: true,
          beginAtZero: false,
          stepSize: 100000
        }
      }],
      xAxes: [{
        display: true,
        position: 'bottom',
        gridLines: {
          drawBorder: false,
          display: false,
        },
        ticks: {
          display: true,
          beginAtZero: true,
          stepSize: 5
        }
      }],

    },
    legend: {
      display: false,
      labels: {
        boxWidth: 0,
      }
    },
    elements: {
      point: {
        radius: 0
      },
      line: {
        tension: .4,
      },
    },
    tooltips: {
      backgroundColor: 'rgba(2, 171, 254, 1)',
    }
  };
  if ($("#ecommerceAnalytic").length) {
    
    if (saleschart == null) {
      var lineChartCanvas = $("#ecommerceAnalytic").get(0).getContext("2d");
      saleschart = new Chart(lineChartCanvas, {
        type: 'bar',
        data: eCommerceAnalyticData,
        options: eCommerceAnalyticOptions
      });
    }
    else{
      saleschart.data = eCommerceAnalyticData;
      saleschart.options = eCommerceAnalyticOptions;
      saleschart.update();
    }
    
  }
  }
</script>

<script>
  function updateEcommerceGraph(rawDate) {
    date = rawDate.split("*")
    $.ajax({
      url: window.location.origin + "/get_Datedata?from_date=" + date[0] + "&to_date=" + date[1],
      success: function (data) {
        $("#dropdownMenuSizeButton4").text(rawDate);
        var sale = data.result.map(function (e, i) { return e["Sale"] });
        var target = data.result.map(function (e, i) { return e["Target"] });
        var labels = data.result.map(function (e, i) { return e["salesgroup"] });
        makeEcommerceGraph(sale, target, labels);
      }
    })
  }
</script>



<!-- new  Closing Stock Report-->

<script>
  $(document).ready(
    function () {
 
      var barChartStackedData = {
    // labels: ["jan", "feb", "mar", "apr", "may", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
    labels: {{ salesgroup_stock| tojson}},
    datasets: [{
      label: 'Opening',
      data:{{opening_stock| tojson}},
      // data: [10,20,15,30,20,10,20,15,30,20, 10,20,],
      // backgroundColor: [
      //   'rgb(255, 0, 0)',
       
      // ],
      backgroundColor: "rgba(255, 0, 54)",
      borderColor: [
        '#2b80ff',
        
       
      ],
      borderWidth: 1,
      fill: false
    },
    {
      label: 'Closing',
      data :{{closing_stock|tojson}},
      // data: [5,25,10,20,30,5,25,10,20,30,25,10],
      // backgroundColor: [
      //   'rgb(0, 0, 255)',
      
      // ],
      backgroundColor: "rgb(0, 0, 255)",
      borderColor: [
        '#bfccda',
       
      ],
      borderWidth: 1,
      fill: false
    },
    {
      label: 'Primary_Stock',
      data :{{primary_stock_stock|tojson}},
      // data: [5,25,10,20,30,5,25,10,20,30,25,10],
      // backgroundColor: [
      //   'rgb(0, 0, 255)',
      
      // ],
      backgroundColor: "#22bb33",
      borderColor: [
        '#bfccda',
       
      ],
      borderWidth: 1,
      fill: false
    },
   
    {
      label: 'Secondary',
      data :{{Secondary_stock|tojson}},
      // data: [5,25,10,20,30,5,25,10,20,30,25,10],
      // backgroundColor: [
      //   'rgb(255, 165, 0)',
      
      // ],
      backgroundColor: "rgb(255, 165, 0)",
      borderColor: [
        '#bfccda',
       
      ],
      borderWidth: 1,
      fill: false
    }]
  };
  var barChartStackedOptions = {
    scales: {
      xAxes: [{
        display: true,
        // stacked: true,
        gridLines: {
          display: false, //this will remove only the label
          drawBorder: false,
        },
        ticks: {
        display: true,
      }
      }],
      yAxes: [{

      display: true,
      gridLines: {
        drawBorder: false,
        display: true,
      },
      ticks: {
        display: true,
        beginAtZero: true,
        stepSize: 100000
      }
    }],



      // yAxes: [{
      //   stacked: true,
      //   display: false,
        
      // }]
    },
    legend: {
      display: false,
      position: "bottom"
    },
    legendCallback: function(chart) {
      var text = [];
      text.push('<div class="row">');
      for (var i = 0; i < chart.data.datasets.length; i++) {
        text.push('<div class="col-sm-5 mr-3 ml-3 ml-sm-0 mr-sm-0 pr-md-0 mt-3"><div class="row align-items-center"><div class="col-2"><span class="legend-label" style="background-color:' + chart.data.datasets[i].backgroundColor[i] + '"></span></div><div class="col-9"><p class="text-dark m-0">' + chart.data.datasets[i].label + '</p></div></div>');
        text.push('</div>');
      }
      text.push('</div>');
      return text.join("");
    },
    elements: {
      point: {
        radius: 0
      }
    }

  };

  if ($("#barChartStacked").length) {
    var barChartCanvas = $("#barChartStacked").get(0).getContext("2d");
    // This will get the first returned node in the jQuery collection.
    var barChart = new Chart(barChartCanvas, {
      type: 'bar',
      data: barChartStackedData,
      options: barChartStackedOptions
    });
  }
}
)
</script>



<!-- doughnut chart Scheme summary -->
<script>
  const data = {
    // labels: ['SweetSummerOffer2', 'SpecialDiscountoffer', 'Mansoonoffer', 'WinterSpecialoffer', 'Eksebadhkarek2', 'NewYearDhamaka'],
    datasets: [{
      labels: ['SweetSummerOffer2', 'SpecialDiscountoffer', 'Mansoonoffer', 'WinterSpecialoffer', 'Eksebadhkarek2', 'NewYearDhamaka'],
      data: [58506, 31479, 25832, 10113, 32844, 176585],
      backgroundColor: [
        '#FF0000',
        '#800080',
        '#32CD32',
        '#ff0080',
        '#ffff00',
        '#0000CD'
        
      ],
      borderColor: [
        'rgba(255, 99, 132, 1)',
        'rgba(54, 162, 235, 1)',
        'rgba(255, 206, 86, 1)',
        'rgba(75, 192, 192, 1)',
        'rgba(153, 102, 255, 1)',
        'rgba(255, 159, 64, 1)'
      ],
      borderWidth: 1
    }]
  };

  // Draw the doughnut chart
  const ctx = document.getElementById('myDoughnutChart').getContext('2d');
  const myDoughnutChart = new Chart(ctx, {
    type: 'doughnut',
    data: data,
    options: {
      responsive: false, 
      maintainAspectRatio: false,
    }
  });
</script>



{% endblock %}